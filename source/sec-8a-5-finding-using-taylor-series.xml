<?xml version="1.0" encoding="UTF-8" ?>
<!-- **********************************************************************-->
<!-- Copyright 2012-2025                                                   -->
<!-- Matthew Boelkins                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Calculus.                                 -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->

<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-8a-5-finding-using-taylor-series">
  <title>Finding and using Taylor series</title>
  <objectives>
    <ul>
      <li>
        <p>
          Is it possible to find the Taylor series expansion for a given function <m>f</m> without computing and evaluating various derivatives of <m>f</m>?
        </p>
      </li>
      <li>
        <p>
          Can we differentiate or integrate a Taylor series in the same way that we differentiate or integrate a polynomial?  If so, how does doing so affect the values of <m>x</m> for which the Taylor series converges?
        </p>
      </li>
    </ul>

  </objectives>

  <subsection>
    <title>Introduction</title>
    <p>
      So far, we have focused our attention on a collection of five basic functions functions <mdash/> <m>\frac{1}{1-x}</m>, <m>\ln(1+x)</m>, <m>\sin(x)</m>, <m>\cos(x)</m>, and <m>e^x</m> <mdash/> and their Taylor series centered at <m>a = 0</m>.  One of the reasons we were able to find these Taylor series is the patterns that arise in the derivatives of each of these functions.  While we can always use <xref ref="D-8a-4-Taylor-series">Definition</xref> to find the first few terms of the Taylor series, for most functions it is much more challenging to find a pattern among the various derivatives that allows us to state the general <m>n^{\text{th}}</m> term of the series.  
    </p>

    <p>
      In <xref ref="PA-8a-5">Preview Activity</xref>, we explore this issue and investigate a different approach to finding the Taylor series of a given function. 
    </p>

  <xi:include href="./previews/PA-8a-5-WW.xml" /> 
  <xi:include href="./previews/PA-8a-5.xml" />

  </subsection>  

  <subsection>
    <title>Using substitution and algebra to find new Taylor series expressions</title>
    <p>
      The substitution technique we used in <xref ref="PA-8a-5">Preview Activity</xref> can be used to find the Taylor series for any function whose structure is similar to that of a Taylor series we already know.  
    </p>

    <example xml:id="ex-8a-5-cosx3">
      <statement>
        <p>
          Find the Taylor series expansion for <m>g(x) = x^4 \cos(x^3)</m> and determine the set of all <m>x</m>-values for which the series converges.
        </p>
      </statement>
      <solution>
        <p>
          Because <m>\cos(x^3)</m> is part of the function whose Taylor series we seek, we start with the familiar series for <m>\cos(x)</m>.  We know that 
          <men xml:id="eq-8a-5-cosu">
            f(u) = \cos(u) = 1 - \frac{1}{2!}u^2 + \frac{1}{4!}u^4 - \cdots + (-1)^n \frac{1}{(2n)!} u^{2n} + \cdots
          </men>
          for all real numbers <m>u</m>. 
        </p>

        <p>
          By letting <m>u = x^3</m> in <xref ref="eq-8a-5-cosu">Equation</xref>, it follows that
          <me>
            \cos(x^3) = 1 - \frac{1}{2!}(x^3)^2 + \frac{1}{4!}(x^3)^4 - \cdots + (-1)^n \frac{1}{(2n)!} (x^3)^{2n} + \cdots
          </me>, 
          so
          <men xml:id="eq-8a-5-cosx3">
            \cos(x^3) = 1 - \frac{1}{2!}x^6 + \frac{1}{4!}x^{12} - \cdots + (-1)^n \frac{1}{(2n)!} x^{6n} + \cdots
          </men>.      
          Then, multiplying both sides of <xref ref="eq-8a-5-cosx3">Equation</xref> by <m>x^4</m>, we find that 
          <me>
            g(x) = x^4 \cos(x^3) = x^4 - \frac{1}{2!}x^{10} + \frac{1}{4!}x^{16} - \cdots + (-1)^n \frac{1}{(2n)!} x^{6n+4} + \cdots
          </me>.
          Since <xref ref="eq-8a-5-cosu">Equation</xref> is valid for every real number <m>u</m>, letting <m>u = x^3</m> tells us that <xref ref="eq-8a-5-cosx3">Equation</xref> is valid for every real number <m>x</m>.  The Ratio Test can be used to show that multiplying every term of a Taylor series by the same power of <m>x</m> does not change the set of <m>x</m>-values for which the series converges, so the Taylor series for <m>g(x)</m> also converges for every value of <m>x</m>.
        </p>          
      </solution>
    </example>

    <p>
      Because the approaches in <xref ref="PA-8a-5">Preview Activity</xref> and <xref ref="ex-8a-5-cosx3">Example</xref> each require us to use a known Taylor series, we restate the Taylor series we've established so far for <m>5</m> important functions in <xref ref="T-8a-5-big-5-redux">Table</xref>.  These <m>5</m> Taylor series will also be valuable when we soon learn another approach for finding series representations of other more complicated functions.
    </p>

    <assemblage>
      <title>Important Taylor series representations</title>
      <p>
      <table xml:id="T-8a-5-big-5-redux">
            <title>Taylor series and the open intervals of <m>x</m>-values where they converge for <m>5</m> important functions.</title>
              <tabular>
                <row bottom="minor">
                  <cell halign="center"> <m>f(x)</m></cell>
                  <cell>Taylor series, <m>T_f</m>, centered at <m>0</m></cell>
                  <cell><m>f(x) = T_f(x)</m></cell>
                </row>
                <row>
                  <cell halign="center"><m>\frac{1}{1-x}</m></cell>
                  <cell><m>\sum_{k=0}^{\infty} x^k = 1 + x + x^2 + x^3 + \cdots</m></cell>
                  <cell>if <m>|x| \lt 1</m></cell>
                </row>
                <row>
                  <cell halign="center"><m>\ln(1+x)</m></cell>
                  <cell><m>\sum_{k=1}^{\infty} (-1)^{k-1} \frac{x^k}{k}  = x - \frac{1}{2}x^2 + \frac{1}{3}x^3 - \cdots</m></cell>
                  <cell>if <m>|x| \lt 1</m></cell>
                </row>
                <row>
                  <cell halign="center"><m>\sin(x)</m></cell>
                  <cell><m>\sum_{k=0}^{\infty} (-1)^{k} \frac{x^{2k+1}}{(2k+1)!} = x - \frac{1}{3!}x^3 + \frac{1}{5!}x^5 - \cdots</m></cell>
                  <cell>for all real <m>x</m></cell>
                </row>
                <row>
                  <cell halign="center"><m>\cos(x)</m></cell>
                  <cell><m>\sum_{k=0}^{\infty} (-1)^{k} \frac{x^{2k}}{(2k)!} = 1 - \frac{1}{2!}x^2 + \frac{1}{4!}x^4 - \cdots</m></cell>
                  <cell>for all real <m>x</m></cell>
                </row>
                <row>
                  <cell halign="center"><m>e^x</m></cell>
                  <cell><m>\sum_{k=0}^{\infty} \frac{x^k}{k!} = 1 + x + \frac{1}{2!}x^2 + \frac{1}{3!}x^3 + \cdots</m></cell>
                  <cell>for all real <m>x</m></cell>
                </row>
              </tabular>
            </table>   
            </p>
    </assemblage>      
    <p>
      In <xref ref="act-8a-5-1">Activity</xref>, we find several Taylor series using substitution and algebraic techniques.
    </p>

    <xi:include href="./activities/act-8a-5-1.xml" />

  </subsection>

  <subsection>
    <title>
      Differentiating and integrating Taylor series
    </title>

    <p>
      In <xref ref="C-5">Chapter</xref>, we discussed the challenge posed by definite integrals such as
      <me>
        \int_0^1 \sin(x^2) \, dx
      </me>.
      Because we are unable to find a simple algebraic antiderivative for the function <m>\sin(x^2)</m>, we cannot use the First Fundamental Theorem of Calculus to evaluate the integral exactly.  We learned in <xref ref="sec-5-2-FTC2">Section</xref> that the Second Fundamental Theorem of Calculus provides us with an antiderivative of a given function by using an integral function: one antiderivative of <m>f(x) = \sin(x^2)</m> is 
      <me>
        F(x) = \int_0^x \sin(u^2) \, du
      </me>. 
    </p>

    <p>
      Our recent work with Taylor series now suggests another way to find an antiderivative <m>F(x)</m> for <m>f(x) = \sin(x^2)</m>, and this approach also provides new options for finding additional Taylor series.  In <xref ref="act-8a-5-1">Activity</xref>, as part of our work in finding a Taylor series for <m>x^3 \sin(x^2)</m> we found that
      <men xml:id="eq-8a-5-ex2">
        \sin(x^2) = x^2 - \frac{1}{3!}x^6 + \frac{1}{5!}x^{10} - \cdots + (-1)^{n-1} \frac{1}{(2n-1)!} x^{4n-2} + \cdots
      </men>
      and that this representation of <m>\sin(x^2)</m> is valid for every value of <m>x</m>.  This infinite series representation suggests that we could find an antiderivative <m>F(x)</m> of <m>\sin(x^2)</m> by using <xref ref="eq-8a-5-ex2">Equation</xref> to actually evaluate the integral <m> \int_0^x \sin(u^2) \, du</m>.  Doing so, we see
      <md>
        <mrow>F(x) \amp= \int_0^x \sin(u^2) \, du</mrow>
        <mrow> \amp= \int_0^x \left( u^2 - \frac{1}{3!}u^6 + \frac{1}{5!}u^{10} + \cdots + (-1)^{n+1} \frac{1}{(2n-1)!} u^{4n-2} + \cdots \right) \, du</mrow>
        <mrow>\amp= \left. \frac{1}{3}u^3 - \frac{1}{7 \cdot 3!} u^7 + \frac{1}{11 \cdot 5!}u^{11} + \cdots + \frac{(-1)^{n+1}}{(4n-1)(2n-1)!} u^{4n-1} + \cdots \right|_0^x</mrow>
        <mrow>\amp= \left( \frac{1}{3}x^3 - \frac{1}{7 \cdot 3!} x^7 + \frac{1}{11 \cdot 5!}x^{11} + \cdots + \frac{(-1)^{n+1}}{(4n-1)(2n-1)!} x^{4n-1} + \cdots \right) - 0</mrow>    
        <mrow>\amp= \frac{1}{3}x^3 - \frac{1}{7 \cdot 3!} x^7 + \frac{1}{11 \cdot 5!}x^{11} + \cdots + \frac{(-1)^{n+1}}{(4n-1)(2n-1)!} x^{4n-1} + \cdots </mrow>                    
      </md>
    </p>

    <p>
      Hence we have found that 
      <me>
        F(x) = \frac{1}{3}x^3 - \frac{1}{7 \cdot 3!} x^7 + \frac{1}{11 \cdot 5!}x^{11} + \cdots + \frac{(-1)^{n+1}}{(4n-1)(2n-1)!} x^{4n-1} + \cdots
      </me>
      is an antiderivative of <m>f(x) = \sin(x^2)</m>.
    </p>

    <p>
      It turns out that integrating a Taylor series has no effect on the open<fn>It is possible for the convergence status at the endpoints of the interval to change, but we are normally not concerned with those specific <m>x</m>-values.</fn> interval of convergence of a Taylor series, nor does differentiating such a series.  This fact is stated formally in a result called The Power Series Differentiation and Integration Theorem.  A <term>power series</term> is any series of the form 
      <me>f(x) = \sum_{k=0}^{\infty} c_k (x-a)^k</me>.
      Every Taylor series is a power series, and a famous result called Borel's Theorem tells us that every power series is in fact the Taylor series of a related function.
    </p>

    <assemblage xml:id="T-PS-diff-int">
      <title>The Power Series Differentiation and Integration Theorem</title>
      <p>
        If <m>f(x) = \sum_{k=0}^{\infty} c_k (x-a)^k</m> converges on the open interval <m>|x-a| \lt R</m> for a positive real number <m>R</m>, then
        <me>
          f'(x) = \sum_{k=1}^{\infty} k \cdot c_k (x-a)^{k-1}
        </me>
        and 
        <me>
          \int f(x) \, dx = C + \sum_{k=0}^{\infty} \frac{c_k}{k+1} (x-a)^{k+1}
        </me>
        and both of these series converge on the same open interval, <m>|x-a| \lt R</m>.
      </p>
    </assemblage>

    <p>
      Note how the index of representation of <m>f'(x)</m> in sigma notation changes.  This is because if we originally have 
      <me>
        f(x) = c_0 + c_1(x-1) + c_2(x-a)^2 + c_3(x-a)^3 + \cdots + c_k(x-a)^k + \cdots
      </me>
      and we differentiate, we get
      <me>
        f'(x) = c_1 + 2c_2(x-a) + 3c_3(x_a)^2 + \cdots + k \cdot c_k(x-a)^{k-1} + \cdots
      </me>
      and so to have sigma notation for <m>f'(x)</m>, we start with <m>k=1</m> to accommodate the fact that the general term is <m>k \cdot c_k(x-a)^{k-1}</m> in order to ensure all powers of <m>x</m> are nonnegative.
    </p>

    <p>
      Furthermore, this result shows that differentiating or integrating a power series has no effect on radius of convergence of the power series.  Stated more informally, the Power Series Differentiation and Integration Theorem tells us that when it comes to differentiating or integrating a Taylor series, we can do so just as if they were finite polynomials:  we can differentiate or integrate the Taylor series term-wise following the Power Rule for differentiating or integrating <m>x^n</m>.  Moreover, doing so doesn't change the open interval on which the Taylor series converges<fn>Differentiating or integrating can change the convergence status at the endpoints of the interval, but we again will not concern ourselves with that issue .</fn>.  Since polynomials are the easiest of all functions to differentiate and integrate, we can now find many more Taylor series of interesting functions, and even find Taylor series of some familiar functions in different ways.
    </p>

    <example>
      <statement>
        <p>
          Use the familiar Taylor series for <m>g(x) = \frac{1}{1-x}</m> to develop the Taylor series for <m>h(x) = \ln(1+x)</m> using the Power Series Differentiation and Integration Theorem.
        </p>
      </statement>
      <solution>
        <p>
          In <xref ref="Ex-8a-2-Taylor-example">Example</xref>, we developed the Taylor polynomials centered at <m>a = 0</m> for <m>h(x) = \ln(1+x)</m>, using the definition.  And in <xref ref="Ex-8a-4-ln-1-plus-x">Example</xref>, we considered the Taylor series for <m>h(x) = \ln(1+x)</m> that we deduced from patterns in the Taylor polynomials.  
        </p>
        <p>  
          Here, we take a different approach to finding the Taylor series for <m>h(x) = \ln(1+x)</m> that starts with the familiar geometric series expansion of <m>g(x) = \frac{1}{1-x}</m>.
        </p>

        <p>
          The key insight in this approach is the fact that 
          <me>
            \frac{d}{dx}\left[ \ln(1+x) \right] = \frac{1}{1+x}
          </me>.
          We thus first find a Taylor series representation for <m>\frac{1}{1+x}</m>, and then integrate to find the Taylor series for <m>\ln(1+x)</m>.          
        </p>

        <p>
          We know that for <m>|x| \lt 1</m>, 
          <me>
            g(x) = \frac{1}{1-x} = 1 + x + x^2 + x^3 + \cdots + x^n + \cdots
          </me>.
          Using the variable <m>u</m> instead (in anticipation of a change of variables), we have
          <me>
            g(u) = \frac{1}{1-u} = 1 + u + u^2 + u^3 + \cdots + u^n + \cdots
          </me>.
          Next, letting <m>u = -x</m>, it follows that 
          <md>
            <mrow> g(-x) = \frac{1}{1+x} \amp= 1 + (-x) + (-x)^2 + (-x)^3 + \cdots + (-x)^n + \cdots </mrow>
            <mrow>                       \amp=  1 - x + x^2 - x^3 + \cdots + (-1)^n x^n + \cdots</mrow>
          </md>,
          which also converges for <m>|x| \lt 1</m>.
        </p>
        <p>
          Now, since <m>\frac{1}{1+x}</m> is the derivative of <m>\ln(1+x)</m> and <m>\ln(1) = 0</m>, we can use the Second FTC to write
                <me>
                  \ln(1 + x) = \int_0^x \frac{1}{1+t} \, dt
                </me>,
                which combined with our earlier series representation for <m>\frac{1}{1+x}</m> shows that
                <md>
                  <mrow>\ln(1 + x) \amp= \int_0^x \frac{1}{1+t} \, dt</mrow>
                  <mrow>    \amp= \int_0^x 1 - t + t^2 - t^3 + \cdots \, dt</mrow>
                  <mrow>    \amp= \left. t - \frac{1}{2}t^2 + \frac{1}{3} t^3 - \frac{1}{4}t^4 + \cdots \right|_0^x</mrow>
                  <mrow>    \amp= x - \frac{1}{2}x^2 + \frac{1}{3} x^3 - \frac{1}{4}x^4 + \cdots </mrow>
                </md>
                and this series is guaranteed to converge on the same open interval as the series we started with (<m>-1 \lt x \lt 1</m>).  This is also the same series we found for <m>h(x) = \ln(1+x)</m> working directly from the definition of a Taylor polynomial in <xref ref="Ex-8a-2-Taylor-example">Example</xref>.
        </p>

      </solution>
    </example>

    <xi:include href="./activities/act-8a-5-2.xml" />

    <xi:include href="./activities/act-8a-5-3.xml" />

    <p>
      Near the end of <xref ref="sec-8a-4-taylor-series">Section</xref>, we noted the important big-picture perspective that for familiar basic functions that are infinitely differentiable, such as <m>f(x) = \sin(x)</m>, not only can we find the function's Taylor series and determine the open interval of <m>x</m>-values for which the Taylor series converges, but <em>the Taylor series converges to the function itself</em>.  Furthermore, we noted that these representations play a key role in how computers provide decimal approximations to quantities such as <m>e^1</m>, which can be represented as 
      <me>
        e^1 = 1 + 1 + \frac{1}{2!} + \frac{1}{3!} + \frac{1}{4!} + \cdots
      </me>.
      Our most recent work with Taylor series shows that the news is better still:  now we can easily represent even more complicated functions with Taylor series, such as <m>f(x) = e^{-x^2}</m> and <m>g(x) = \sin(x^2)</m>, and determine their antiderivatives using their infinite Taylor series and treating that representation just like a polynomial.  In  
      <xref ref="sec-8a-5x-accuracy-of-approx">Section</xref>, we investigate further how certain infinite series of numbers can  be easily and accurately approximated using partial sums that result from evaluating Taylor series, and how we can even quantify how much error is present in certain partial sum approximations.
    </p>


  </subsection>

  
  <subsection>
    <title>Summary</title>
    <p>
    <ul>
      <li>
        <p>
          Through substitution, we can use any known Taylor series to find the Taylor series of a related function.  For example, we know that if <m>|u| \lt 1</m>, 
          <me>
            \ln(1+u) = u - \frac{1}{2}u^2 + \frac{1}{3}u^3 - \frac{1}{4}u^4 + \cdots
          </me>
          Letting <m>u = 4x^2</m>, it follows that 
          <me>
            \ln(1+4x^2) = 4x^2 - \frac{1}{2} \cdot 16x^4 + \frac{1}{3} \cdot 64x^6  - \frac{1}{4} \cdot 256x^8 + \cdots
          </me>
          and that this representation converges if <m>|4x^2| \lt 1</m>, so for <m>x</m> such that <m>|x| \lt \frac{1}{2}</m>.
        </p>
      </li>
      <li>
        <p>
          The Power Series Differentation and Integration Theorem tells us that we can differentiate or integrate a Taylor series in the natural way and that doing so has essentially no impact on the set of <m>x</m>-values for which the series converges.  For instance, we might note that if we first found the Taylor series for <m>\sin(x)</m>, which is
          <me>
            \sin(x) = x - \frac{1}{3!}x^3 + \frac{1}{5!}x^5 - \frac{1}{7!}x^7 + \cdots
          </me>
          and converges for every value of <m>x</m>, it follows by differentating that
          <md>
            <mrow>\cos(x) \amp= \frac{d}{dx}[\sin(x)]</mrow>
            <mrow>        \amp=  \frac{d}{dx}[x - \frac{1}{3!}x^3 + \frac{1}{5!}x^5 - \frac{1}{7!}x^7 + \cdots]</mrow>
            <mrow>        \amp=  1 - \frac{1}{3!} \cdot 3x^2 + \frac{1}{5!} \cdot 5x^4 - \frac{1}{7!} \cdot 7x^6 + \cdots</mrow>
            <mrow>        \amp=  1 - \frac{1}{2!}x^2 + \frac{1}{4!} x^4 - \frac{1}{6!} x^6 + \cdots</mrow>
          </md>
          which is precisely the Taylor series for <m>\cos(x)</m> that we found by taking derivatives and applying <xref ref="D-8a-4-Taylor-series">Definition</xref>.
        </p>
      </li>
    </ul>
    </p>
  </subsection>

  <xi:include href="./exercises/ez-8a-5.xml" /> 

</section>
